[tox]
envlist=base, lint, mypy, pyright, apiview
skipsdist=True
setenv =
  PYTEST = pytest mock_api_tests ../generic_mock_api_tests
  PIP_INSTALL_SDK_PYLINT = pip install azure-pylint-guidelines-checker==0.4.1 --index-url="https://pkgs.dev.azure.com/azure-sdk/public/_packaging/azure-sdk-for-python/pypi/simple/"
  PYLINT = python ../../eng/scripts/ci/run_pylint.py -t unbranded -s "generated" {posargs}
  MYPY = python ../../eng/scripts/ci/run_mypy.py -t unbranded -s "generated" {posargs}
  PYRIGHT = python ../../eng/scripts/ci/run_pyright.py -t unbranded -s "generated" {posargs}
  PIP_INSTALL_APIVIEW = pip install ../../../../../azure-sdk-tools/packages/python-packages/apiview-stub-generator --extra-index-url="https://pkgs.dev.azure.com/azure-sdk/public/_packaging/azure-sdk-for-python/pypi/simple/"
  APIVIEW = python ../../eng/scripts/ci/run_apiview.py -t unbranded -s "generated" {posargs}

[testenv:ci]
deps = -r requirements.txt
commands =
    {env:PYTEST}
    {env:PIP_INSTALL_SDK_PYLINT}
    {env:PYLINT}
    {env:MYPY}
    {env:PYRIGHT}
    {env:PIP_INSTALL_APIVIEW}
    {env:APIVIEW}

[testenv:test]
deps=
    -r requirements.txt
commands =
    {env:PYTEST}

[testenv:lint]
deps=
    {[testenv:base]deps}
commands =
    {env:PIP_INSTALL_SDK_PYLINT}
    {env:PYLINT}

[testenv:mypy]
deps=
    {[testenv:base]deps}
commands =
    {env:MYPY}

[testenv:pyright]
deps=
    {[testenv:base]deps}
commands =
    {env:PYRIGHT}

[testenv:apiview]
deps=
    {[testenv:base]deps}
commands =
    {env:PIP_INSTALL_APIVIEW}
    {env:APIVIEW}
